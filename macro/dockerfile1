FROM golang:1.16 as build

# ENV GOPROXY https://goproxy.cn
# RUN go env -w GOPRIVATE=github.com/bytom/common,github.com/bytom/blockcenter-bytom,github.com/bytom/bycoin-bytom,github.com/bytom/bytom,github.com/bytom/oracle,github.com/bytom/bycoinhub,github.com/bytom/ofmf-summary

WORKDIR /go/release

RUN pwd

# ADD . .

# ARG USER
# ENV USER=$USER

# ARG TOKEN
# ENV TOKEN=$TOKEN

# RUN git config --global url."https://${USER}:${TOKEN}@github.com".insteadOf "https://github.com"
# RUN go get & GOOS=linux CGO_ENABLED=0 go build -installsuffix cgo -o target/main cmd/api/main.go

FROM scratch as prod

# COPY --from=build /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
# COPY --from=build /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/ca-certificates.crt
# COPY --from=build /go/release/target/main /main

# EXPOSE 3000

# CMD ["/main","/config.json"]
